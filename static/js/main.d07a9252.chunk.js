(this["webpackJsonpflying-lines"]=this["webpackJsonpflying-lines"]||[]).push([[0],{136:function(e,t,a){"use strict";a.r(t);var n=a(3),r=a.n(n),s=a(22),i=a.n(s),o=(a(64),a(42),a(53)),l=a(54),d=a(58),c=a(57),u=a(8),g=a.n(u),m=a(38),h=a.n(m),f=(a(72),function(e){Object(d.a)(a,e);var t=Object(c.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).handleFileChosen=function(e){console.log("file chosen",e);var t=new FileReader;t.onload=n.handleFileRead,t.readAsBinaryString(e)},n.getReadableHours=function(e){return e.H.toString().padStart(2,"0")+":"+e.M.toString().padStart(2,"0")},n.getDateObj=function(e){return new Date(e.y,e.m-1,e.d)},n.getComparibleDate=function(e){return e.y.toString()+e.m.toString().padStart(2,"0")+e.d.toString().padStart(2,"0")},n.handleFileRead=function(e){var t=e.target.result,a=g.a.read(t,{type:"binary"}),r=a.SheetNames[0],s=a.Sheets[r];n.setState({data:g.a.utils.sheet_to_json(s,{sheets:["FlightList"]})})},n.handleFormSubmit=function(e){var t=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],a=["January","February","March","April","May","June","July","August","September","October","November","December"],r={d:n.state.startDate.getDate(),m:n.state.startDate.getMonth()+1,y:n.state.startDate.getFullYear()},s={d:n.state.endDate.getDate(),m:n.state.endDate.getMonth()+1,y:n.state.endDate.getFullYear()};console.log(r,s),n.setState({flights:[]});for(var i=[],o=0;o<=n.state.data.length;o++)if("undefined"!==typeof n.state.data[o]&&("MAN"===n.state.data[o].Dest||"MAN"===n.state.data[o].Orig)){var l=g.a.SSF.parse_date_code(n.state.data[o].Start),d=g.a.SSF.parse_date_code(n.state.data[o].End),c=g.a.SSF.parse_date_code(n.state.data[o]["STA (Loc)"]),u=g.a.SSF.parse_date_code(n.state.data[o]["STD (Loc)"]);if(n.getComparibleDate(l)<=n.getComparibleDate(s)&&n.getComparibleDate(d)>=n.getComparibleDate(r))for(var m=n.getDateObj(l),h=n.getDateObj(d),f=n.getDateObj(r),D=n.getDateObj(s),y=n.state.data[o].Pattern,S=(y=y.substr(6,1)+y.substr(0,6)).split("");f.getTime()<=D.getTime();)if(m.getTime()>f.getTime()||h.getTime()<f.getTime())console.log("Skipping as starts in future or ends in past"),f.setDate(f.getDate()+1);else{if("."!==S[f.getDay()]){console.log("We fly on "+t[f.getDay()],n.state.data[o]);var p={Al:n.state.data[o].Al,flNo:n.state.data[o].FlNo.trim(),Date:t[f.getDay()].substr(0,3)+" "+f.getDate().toString().padStart(2,"0")+"/"+a[f.getMonth()].substr(0,3)+"/"+f.getFullYear(),Orig:n.state.data[o].Orig,"STD (Loc)":n.getReadableHours(u),"STA (Loc)":n.getReadableHours(c),Dest:n.state.data[o].Dest,Own:n.state.data[o].Own,"A/C":n.state.data[o]["A/C"]};i.push(p)}f.setDate(f.getDate()+1)}}n.setState({flights:i});var b=g.a.utils.json_to_sheet(i),v=g.a.utils.book_new();g.a.utils.book_append_sheet(v,b,"Flying Lines"),g.a.writeFile(v,"flying-lines.xlsx")},n.state={data:null,flights:[],startDate:new Date,endDate:new Date},n}return Object(l.a)(a,[{key:"render",value:function(){var e=this;return r.a.createElement("div",null,r.a.createElement("div",null,"Range Start: ",r.a.createElement(h.a,{className:"date-picker",selected:this.state.startDate,dateFormat:"dd/MM/yyyy",onChange:function(t){return e.setState({startDate:t})}})),r.a.createElement("div",null,"Range End: ",r.a.createElement(h.a,{className:"date-picker",selected:this.state.endDate,dateFormat:"dd/MM/yyyy",onChange:function(t){return e.setState({endDate:t})}})),r.a.createElement("div",null,r.a.createElement("input",{type:"file",className:"file-input",id:"schedule-xlsx",onChange:function(t){return e.handleFileChosen(t.target.files[0])}})),r.a.createElement("div",null,r.a.createElement("button",{className:"generate-button",onClick:function(t){return e.handleFormSubmit(t)}},"Generate")))}}]),a}(r.a.Component));var D=function(){return r.a.createElement("div",{className:"main-container"},r.a.createElement("h1",{class:"heading"},"Flying Lines"),r.a.createElement(f,null))};var y=function(){return r.a.createElement("div",{className:"App"},r.a.createElement(D,null))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(y,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},42:function(e,t,a){},44:function(e,t){},59:function(e,t,a){e.exports=a(136)},64:function(e,t,a){},70:function(e,t){},71:function(e,t){}},[[59,1,2]]]);
//# sourceMappingURL=main.d07a9252.chunk.js.map