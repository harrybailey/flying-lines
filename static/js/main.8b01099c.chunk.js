(this["webpackJsonpflying-lines"]=this["webpackJsonpflying-lines"]||[]).push([[0],{136:function(e,t,a){"use strict";a.r(t);var n=a(3),r=a.n(n),s=a(22),o=a.n(s),i=(a(64),a(42),a(53)),l=a(54),d=a(58),c=a(57),u=a(8),g=a.n(u),m=a(38),f=a.n(m),h=(a(72),function(e){Object(d.a)(a,e);var t=Object(c.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).handleFileChosen=function(e){console.log("file chosen",e);var t=new FileReader;t.onload=n.handleFileRead,t.readAsBinaryString(e)},n.getReadableHours=function(e){return e.H.toString().padStart(2,"0")+":"+e.M.toString().padStart(2,"0")},n.getDateObj=function(e){return new Date(e.y,e.m-1,e.d)},n.getComparibleDate=function(e){return e.y.toString()+e.m.toString().padStart(2,"0")+e.d.toString().padStart(2,"0")},n.handleFileRead=function(e){var t=e.target.result,a=g.a.read(t,{type:"binary"}),r=a.SheetNames[0],s=a.Sheets[r];n.setState({data:g.a.utils.sheet_to_json(s,{sheets:["FlightList"]})})},n.handleFormSubmit=function(e){var t=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],a=["January","February","March","April","May","June","July","August","September","October","November","December"],r={d:n.state.startDate.getDate(),m:n.state.startDate.getMonth()+1,y:n.state.startDate.getFullYear()},s={d:n.state.endDate.getDate(),m:n.state.endDate.getMonth()+1,y:n.state.endDate.getFullYear()};console.log(r,s),n.setState({flights:[]});for(var o=[],i=0;i<=n.state.data.length;i++)if("undefined"!==typeof n.state.data[i]&&("MAN"===n.state.data[i].Dest||"MAN"===n.state.data[i].Orig)){var l=g.a.SSF.parse_date_code(n.state.data[i].Start),d=g.a.SSF.parse_date_code(n.state.data[i].End),c=g.a.SSF.parse_date_code(n.state.data[i]["STA (Loc)"]),u=g.a.SSF.parse_date_code(n.state.data[i]["STD (Loc)"]);if(n.getComparibleDate(l)<=n.getComparibleDate(s)&&n.getComparibleDate(d)>=n.getComparibleDate(r))for(var m=n.getDateObj(l),f=n.getDateObj(d),h=n.getDateObj(r),D=n.getDateObj(s),S=n.state.data[i].Pattern,p=(S=S.substr(6,1)+S.substr(0,6)).split("");h.getTime()<=D.getTime();)if(m.getTime()>h.getTime()||f.getTime()<h.getTime())console.log("Skipping as starts in future or ends in past"),h.setDate(h.getDate()+1);else{if("."!==p[h.getDay()]){console.log("We fly on "+t[h.getDay()],n.state.data[i]);var y={Al:n.state.data[i].Al,flNo:n.state.data[i].FlNo.trim(),Date:t[h.getDay()].substr(0,3)+" "+h.getDate().toString().padStart(2,"0")+"/"+a[h.getMonth()].substr(0,3)+"/"+h.getFullYear(),Orig:n.state.data[i].Orig,"STD (Loc)":n.getReadableHours(u),"STA (Loc)":n.getReadableHours(c),Dest:n.state.data[i].Dest,Own:n.state.data[i].Own,"A/C":n.state.data[i]["A/C"]};o.push(y)}h.setDate(h.getDate()+1)}}n.setState({flights:o});var b=g.a.utils.json_to_sheet(o),v=g.a.utils.book_new();g.a.utils.book_append_sheet(v,b,"Flying Lines"),g.a.writeFile(v,"flying-lines.xlsx")},n.state={data:null,flights:[],startDate:new Date,endDate:new Date},n}return Object(l.a)(a,[{key:"render",value:function(){var e=this;return r.a.createElement("div",null,r.a.createElement("div",null,"Range Start: ",r.a.createElement(f.a,{className:"date-picker",selected:this.state.startDate,dateFormat:"dd/MM/yyyy",onChange:function(t){return e.setState({startDate:t})}})),r.a.createElement("div",null,"Range End: ",r.a.createElement(f.a,{className:"date-picker",selected:this.state.endDate,dateFormat:"dd/MM/yyyy",onChange:function(t){return e.setState({endDate:t})}})),r.a.createElement("div",null,r.a.createElement("input",{type:"file",className:"file-input",id:"schedule-xlsx",onChange:function(t){return e.handleFileChosen(t.target.files[0])}})),r.a.createElement("div",null,r.a.createElement("button",{className:"generate-button",onClick:function(t){return e.handleFormSubmit(t)}},"Generate")))}}]),a}(r.a.Component));var D=function(){return r.a.createElement("div",{className:"main-container"},r.a.createElement(h,null))};var S=function(){return r.a.createElement("div",{className:"App"},r.a.createElement(D,null))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(S,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},42:function(e,t,a){},44:function(e,t){},59:function(e,t,a){e.exports=a(136)},64:function(e,t,a){},70:function(e,t){},71:function(e,t){}},[[59,1,2]]]);
//# sourceMappingURL=main.8b01099c.chunk.js.map