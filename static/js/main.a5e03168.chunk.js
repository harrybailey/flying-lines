(this["webpackJsonpflying-lines"]=this["webpackJsonpflying-lines"]||[]).push([[0],{136:function(e,t,a){"use strict";a.r(t);var n=a(3),l=a.n(n),r=a(22),s=a.n(r),i=(a(64),a(42),a(53)),o=a(54),d=a(58),c=a(57),u=a(8),g=a.n(u),m=a(38),h=a.n(m),f=(a(72),function(e){Object(d.a)(a,e);var t=Object(c.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).handleFileChosen=function(e){console.log("file chosen",e);var t=new FileReader;t.onload=n.handleFileRead,t.readAsBinaryString(e)},n.getReadableHours=function(e){return e.H.toString().padStart(2,"0")+":"+e.M.toString().padStart(2,"0")},n.getDateObj=function(e){return new Date(e.y,e.m-1,e.d)},n.getComparibleDate=function(e){return e.y.toString()+e.m.toString().padStart(2,"0")+e.d.toString().padStart(2,"0")},n.handleFileRead=function(e){var t=e.target.result,a=g.a.read(t,{type:"binary"}),l=a.SheetNames[0],r=a.Sheets[l];n.setState({data:g.a.utils.sheet_to_json(r,{sheets:["FlightList"]})})},n.handleFormSubmit=function(e){var t=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],a=["January","February","March","April","May","June","July","August","September","October","November","December"],l={d:n.state.startDate.getDate(),m:n.state.startDate.getMonth()+1,y:n.state.startDate.getFullYear()},r={d:n.state.endDate.getDate(),m:n.state.endDate.getMonth()+1,y:n.state.endDate.getFullYear()};console.log(l,r),n.setState({flights:[]});for(var s=[],i=0;i<=n.state.data.length;i++)if("undefined"!==typeof n.state.data[i]&&("MAN"===n.state.data[i].Dest||"MAN"===n.state.data[i].Orig)){var o=g.a.SSF.parse_date_code(n.state.data[i].Start),d=g.a.SSF.parse_date_code(n.state.data[i].End),c=g.a.SSF.parse_date_code(n.state.data[i]["STA (Loc)"]),u=g.a.SSF.parse_date_code(n.state.data[i]["STD (Loc)"]);if(n.getComparibleDate(o)<=n.getComparibleDate(r)&&n.getComparibleDate(d)>=n.getComparibleDate(l))for(var m=n.getDateObj(o),h=n.getDateObj(d),f=n.getDateObj(l),D=n.getDateObj(r),S=n.state.data[i].Pattern,y=(S=S.substr(6,1)+S.substr(0,6)).split("");f.getTime()<=D.getTime();)if(m.getTime()>f.getTime()||h.getTime()<f.getTime())console.log("Skipping as starts in future or ends in past"),f.setDate(f.getDate()+1);else{if("."!==y[f.getDay()]){console.log("We fly on "+t[f.getDay()],n.state.data[i]);var p={Al:n.state.data[i].Al,FlNo:n.state.data[i].FlNo.trim(),Date:t[f.getDay()].substr(0,3)+" "+f.getDate().toString().padStart(2,"0")+"/"+a[f.getMonth()].substr(0,3)+"/"+f.getFullYear(),Orig:n.state.data[i].Orig,"STD (Loc)":n.getReadableHours(u),"STA (Loc)":n.getReadableHours(c),Dest:n.state.data[i].Dest,Own:n.state.data[i].Own,"A/C":n.state.data[i]["A/C"]};s.push(p)}f.setDate(f.getDate()+1)}}n.setState({flights:s});var b=g.a.utils.json_to_sheet(s),F=g.a.utils.book_new();g.a.utils.book_append_sheet(F,b,"Flying Lines"),g.a.writeFile(F,"flying-lines.xlsx")},n.state={data:null,flights:[],startDate:new Date,endDate:new Date},n}return Object(o.a)(a,[{key:"render",value:function(){var e=this;return l.a.createElement("div",null,l.a.createElement("div",null,"Range Start: ",l.a.createElement(h.a,{className:"date-picker",selected:this.state.startDate,dateFormat:"dd/MM/yyyy",onChange:function(t){return e.setState({startDate:t})}})),l.a.createElement("div",null,"Range End: ",l.a.createElement(h.a,{className:"date-picker",selected:this.state.endDate,dateFormat:"dd/MM/yyyy",onChange:function(t){return e.setState({endDate:t})}})),l.a.createElement("div",null,l.a.createElement("input",{type:"file",className:"file-input",id:"schedule-xlsx",onChange:function(t){return e.handleFileChosen(t.target.files[0])}})),l.a.createElement("div",null,l.a.createElement("button",{className:"generate-button",onClick:function(t){return e.handleFormSubmit(t)}},"Generate")))}}]),a}(l.a.Component));var D=function(){return l.a.createElement("div",{className:"main-container"},l.a.createElement("h1",{class:"heading"},"Flying Lines"),l.a.createElement(f,null),l.a.createElement("div",{class:"guidance"},l.a.createElement("h2",null,"Guidance"),l.a.createElement("ol",null,l.a.createElement("li",null,"Select a start and end date for flying lines."),l.a.createElement("li",null,"Browse and select your schedule .xlsx file"),l.a.createElement("li",null,"Click to generate a flying lines file for download")),l.a.createElement("p",null,"File upload must contain the sheet 'FlightList' and the columns 'Al', 'FlNo', 'Dest', 'Orig', 'Start', 'End', 'STA (Loc)', 'STD (Loc)', 'Own', 'A/C' and 'Pattern'."),l.a.createElement("p",null,"Generated file will named 'flying-lines.xlsx' and contain a single 'Flying Lines' sheet with columns 'Al', 'FlNo', 'Date', 'Orig', 'STD (Loc)', 'STA (Loc)', 'Dest', 'Own', 'A/C'")))};var S=function(){return l.a.createElement("div",{className:"App"},l.a.createElement(D,null))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(l.a.createElement(l.a.StrictMode,null,l.a.createElement(S,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},42:function(e,t,a){},44:function(e,t){},59:function(e,t,a){e.exports=a(136)},64:function(e,t,a){},70:function(e,t){},71:function(e,t){}},[[59,1,2]]]);
//# sourceMappingURL=main.a5e03168.chunk.js.map